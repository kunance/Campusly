{
    "rules": {
        ".read": false,
        ".write": false,
        "users": {
            ".read": "root.child('users/'+auth.uid+'/type').val() === 'admin'",
            "$user": {
                ".read": "auth.uid === $user || root.child('bids/security/'+auth.uid+'/'+$user).exists() || root.child('bids/security/'+$user+'/'+auth.uid).exists()",
                ".write": "auth.uid === $user && ((!data.exists() && newData.child('type').val()!='admin') || (data.exists() && newData.hasChildren() && newData.child('type').val() === data.child('type').val() ))"

            }
        },     
        "featured": {
               ".read": true,
               ".write": false
        },
        "properties": {
               ".read":true,
               "$property":{
                   ".read":true,
                   ".write" : "auth.uid === data.child('owner').val() || (root.child('users/'+auth.uid+'/type').val() === 'owner' && !data.exists())"
               }
        },
        "bids" : {
            ".read": true,
            "all": {
                ".read": true,

                "$bidId": {
                   ".read": true,
                   ".write" : "auth.uid === data.child('userId').val() || (root.child('users/'+auth.uid+'/type').val() === 'tenant' && !data.exists()) || (root.child('users/'+auth.uid+'/type').val() === 'owner' && data.exists() && newData.exists())"
                }
            },
            "property": {
                ".read": true,
                "$propertyId": {
                   ".read": true,
                   "$bidId": {
                      ".read": true,
                      ".write" : "auth.uid === root.child('bids/all/'+$bidId+'/userId').val() || (root.child('users/'+auth.uid+'/type').val() === 'owner' && root.child('properties/'+$propertyId+'/owner').val() === auth.uid)"
                   }
                }
            },
            "user": {
                ".read": true,
                "$userId": {
                   ".read": true,
                   "$propertyId": {
                      ".read": true,
                      ".write" : true
                   }
                }
            },
            "security": {
                ".read": true,
                "$ownerId": {
                   ".read": true,
                   "$tenantId": {
                      ".read": true,
                      ".write" : "(auth.uid === $tenantId && auth.uid === root.child('bids/all/'+newData.val()+'/userId').val()) || (root.child('users/'+auth.uid+'/type').val() === 'owner' && auth.uid === $ownerId)"
                   }
                }
            }
        },
        "watchlist":{
            "$user" : {
              ".read" : true,
              ".write" : "auth.uid === $user"
            }
        },
        "watchers":{
          "$propertyId": {
            ".read" : true,
            "$user" : {
              ".read" : true,
              ".write" : "auth.uid === $user"
            }
          }
        },
        "credit":{
            ".write" : "root.child('users/'+auth.uid+'/type').val() === 'admin'",
            "$user" : {
              ".read" : "root.child('users/'+auth.uid+'/type').val() === 'admin' || root.child('bids/security/'+auth.uid+'/'+$user).exists()"
            }
        },
        "sendQueue": {
            ".read": false,
            ".write": "auth.uid != null && newData.exists()" 
        }
    }
}


